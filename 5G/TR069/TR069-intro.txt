
TR069是 CPE 和 ACS 之间沟通的通讯协定。
CPE 可以借着这个协定完成服务开通、功能设定、档案上传下载、系统检测 等等初始化及营运管理的必须动作。

----------------
CPE,英文全称为Customer Premise Equipment,直译：客户前置设备,
实际是一种接收移动信号并以无线WIFI信号转发出来的移动信号接入设备，它也是一种将高速4G或者5G信号转换成WiFi信号的设备，
可支持同时上网的移动终端数量也较多。CPE可大量应用于农村，城镇，医院，单位，工厂，小区等无线网络接入，能节省铺设有线网络的费用。
-------------

TR-069 全名是 Technical Report - 069 是由 DSL Forum (之后更名为 Broadband Forum) 的技术标准制定组织在 2004 年五月发表公开，
系在 CWMP (CPE WAN Management Protocol) 上发展的一项远程控制使用者终端设备的通讯协定。
之后于 2006, 2007, 2010, 2011及2013年又发表了更新的版本，最新的版本是 1.4。
这套协议也同时整合成为一个平台架构，提供给其它终端装置控管的一个基本平台，让诸如 VoIP 或 STB 装置也能透过这项协定的基础进行管理维护等动作。


########工作要点

对于用户设备来说，TR-069主要完成以下四方面的工作：
一是用户设备自动配置和动态的业务配置。对于ACS来说，每个用户设备可以在协议中对自己作出标志（例如型号、版本等），根据可设定的规则，ACS可以对某一个特定用户设备下发配置，也可以对某一组用户设备下发配置。CPE可以在开机后自动请求ACS中的配置信息，ACS也可在任意需要的时刻主动发起配置。通过该功能可以实现用户设备的“零配置安装”功能，或是可以从网络侧控制业务参数的动态改变。
二是对用户设备的软件、固件的管理。TR-069的协议提供了对用户设备中的软件、固件进行管理和下载的功能。ACS可以识别用户设备的版本号，决定是否远程更新用户设备的软件版本，并且在更新完成后能够得知是否成功。例如，当用户设备需要加载新的软件以实现新的业务功能时，或是当前软件存在必须修复的bug时，通过该功能可以实现对用户设备的远程管理升级。
三是对用户设备的状态和性能进行监测。TR-069定义了ACS对用户设备的状态和性能进行监测的手段。其中包括了一些通用的性能参数，可以反映当前用户设备的工作状态。另外还提供了标准的语法，运营商可以定义额外的参数。
四是对通信故障的诊断。TR-069还定义了可以用户端自我诊断和报告的能力，例如在ACS的指示下，用户端可以通过ping或其它手段检查用户端与网络业务提供点之间的连通性、带宽等，检测结果返回给ACS。这样，运营商通过在远端操作，就可以对用户申告的设备故障进行简单定位，并作相应的处理。

##############协议

TR-069协议的基本思路是利用了在新一代Web服务中广泛使用的基于SOAP的RPC方法。其会话协议使用的是HTTP1．1协议，因此TR-069可以方便地使用在Web中使用的传送层安全技术，比如SSL/TLS。
TR-069协议栈的下面几层充分利用了现在Internet上广泛使用的通信协议，比如TCP、HTTP、SOAP等。通过这些成熟的协议，ACS和用户设备之间可以方便地建立通信的基本通道。TR-069在SOAP之上定义了用于配置、查询、诊断等操作的特定的RPC方法，通信的两端（ACS和用户设备）都可以通过RPC调用来完成某个特定功能的执行和得到返回的结果。
用户设备和ACS之间的通信分为ACS发现阶段和连接建立阶段。在ACS发现阶段，用户设备需要得知ACS的URL或地址，这些信息可以是预配置在用户设备中的，也可以通过DHCP的选项来传送给用户设备。一旦用户设备得到ACS的URL或地址，用户设备可以在任何时候发起对ACS的连接。
在连接过程中，用户设备作为HTTP的客户端，其SOAP请求通过HTTPPOST发送给ACS；而ACS作为HTTP的服务端，其SOAP请求通过HTTPResponse发送给用户设备。在每一个HTTP请求中可以包含多个SOAP请求或响应。为了确保管理配置系统的安全，TR-069建议使用SSL/TLS对用户设备进行认证。如果不使用SSL/TLS，也应使用HTTP1．1中定义的认证方式对用户设备进行认证。
除了上面提到的方式，TR-069还明确了ACS可以向用户设备发起连接请求的规定，用于完成网络侧发起的异步配置动作等。


###########架构

TR069 架构在 HTTP / HTTPS 之上，借由 SOAP 包装 XML 物件做为沟通内容的通讯协议。

#########流程

TR069 可以分开两个阶段来说明，一个是 BootStrap (初始化的阶段)，一个是营运期 (Runtime) 的阶段需要注意。在 BootStrap 时需要完成初始化的动作，在 Runtime 时期主要则是要解决 Parameter Get/Set, Connection Request 等等维护动作上的需求。

##############日常操作

其实一开始的初始化流程其实已经可以称得上是一个简单的操作流程的集合了。在初始化的过程中如果有错误应该使用 faultcode 回报给 ACS Server，但 CPE 不该随意中断这个流程。


GPN	GetParameterNames		用来取得装置上的数据名称
GPV	GetParameterValues		可以取得一个或多个数值，也可以取得完整径或部分路径的数值
SPV	SetParameterValues		用来设定参数数值
GPA	GetParameterAttributes	用来取得参数的特性：只读或可读写，以及主被动回报
SPA	SetParameterAttributes	用来设定参数的特性：只读或可读写，以及主被动回报
-	Download				用以指示 CPE 下载档案处理作为固件更新(FIrmware Upgrade)、
								设定更新(Config Upgrade)，或其它特定的档案处理
-	Upload					用以指示 CPE 上传档案处理作为设定备份(Config Export)，
								或其它特定的档案处理(例如 System log export)
ADD	AddObject				新增参数
DEL	DeleteObject			移除参数



############## TR069协议包含一些该协议特有的组件，同时也使用了一些标准协议，如下:

CPE/ACS Management Application

    RPC Methods
    SOAP
    HTTP
    SSL/TLS
    TCP/IP

TR069 架构在 HTTP / HTTPS 之上，借由 SOAP 包装 XML 物件做为沟通内容的通讯协议。

#### SOAP
简单对象访问协议是交换数据的一种协议规范，是一种轻量的、简单的、基于XML（标准通用标记语言下的一个子集）的协议，
它被设计成在WEB上交换结构化的和固化的信息。 

#### TLS
安全传输层协议（TLS）用于在两个通信应用程序之间提供保密性和数据完整性。
该协议由两层组成： TLS 记录协议（TLS Record）和 TLS 握手协议（TLS Handshake）。 

