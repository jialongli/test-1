哨兵 Sentinel

主从切换技术的方法是：当主服务器宕机后，需要手动把一台从服务器切换为主服务器，
这就需要人工干预，费事费力，还会造成一段时间内服务不可用。这不是一种推荐的方式，
更多时候，我们优先考虑哨兵模式。

哨兵模式概述
哨兵模式是一种特殊的模式，首先Redis提供了哨兵的命令，哨兵是一个独立的进程，作为进
程，它会独立运行。其原理是哨兵通过发送命令，等待Redis服务器响应，从而监控运行的多
个Redis实例。

这里的哨兵有两个作用

通过发送命令，让Redis服务器返回监控其运行状态，包括主服务器和从服务器。

当哨兵监测到master宕机，会自动将slave切换成master，然后通过发布订阅模式通知其他的从服
务器，修改配置文件，让它们切换主机。


然而一个哨兵进程对Redis服务器进行监控，可能会出现问题，为此，我们可以使用多个哨兵
进行监控。各个哨兵之间还会进行监控，这样就形成了多哨兵模式。


用文字描述一下故障切换（failover）的过程。假设主服务器宕机，哨兵1先检测到这个结果，
系统并不会马上进行failover过程，仅仅是哨兵1主观的认为主服务器不可用，这个现象成为主观下线。
当后面的哨兵也检测到主服务器不可用，并且数量达到一定值时，那么哨兵之间
就会进行一次投票，投票的结果由一个哨兵发起，进行failover操作。切换成功后，就会通过
发布订阅模式，让各个哨兵把自己监控的从服务器实现切换主机，这个过程称为客观下线。
这样对于客户端而言，一切都是透明的。
